<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title></title>
<script type="text/javascript" src="/layui/layui.js"></script>
<script type="text/javascript" src="/js/propJFA.js"></script>
<script type="text/javascript" src="/js/config.js"></script>
<script type="text/javascript" src="/js/jquery-3.3.1.js"></script>
<script type="text/javascript">
Date.prototype.format = function(fmt) { 
    var o = { 
       "M+" : this.getMonth()+1,                 //月份 
       "d+" : this.getDate(),                    //日 
       "h+" : this.getHours(),                   //小时 
       "m+" : this.getMinutes(),                 //分 
       "s+" : this.getSeconds(),                 //秒 
       "q+" : Math.floor((this.getMonth()+3)/3), //季度 
       "S"  : this.getMilliseconds()             //毫秒 
   }; 
   if(/(y+)/.test(fmt)) {
           fmt=fmt.replace(RegExp.$1, (this.getFullYear()+"").substr(4 - RegExp.$1.length)); 
   }
    for(var k in o) {
       if(new RegExp("("+ k +")").test(fmt)){
            fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : (("00"+ o[k]).substr((""+ o[k]).length)));
        }
    }
   return fmt; 
}        
</script>
<style type="text/css">
table
  {
  width:90%;
  }

th
  {
  height:30px;
  }
	table,td,th{
		border: 2px solid black;
		border-collapse: collapse ;
	}
	td{
		text-align:center;
	}
</style>
</head>
<body>
	<div id="d"></div>
	<button>打印</button>
<script type="text/javascript">
	var loc = location.href;
    var n1 = loc.length;//地址的总长度  
    var n2 = loc.indexOf("=");//取得=号的位置  
    var id = decodeURI(loc.substr(n2+1, n1-n2));//从=号后面的内容 
   	var res = synAjax("GET", '/v0.1/sell/list', null, '查询失败!');
   	for (var i = 0; i < res.length; i++) {
		if (res[i].id ==id) {
			var time = new Date(res[i].createTime).format("yyyy-MM-dd");
			var goods = synAjax("GET", '/v0.1/sell/list/'+id, null, '查询失败!');
			var str = "";
			for (var j = 0; j < goods.length; j++) {
				str +=
				'	<tr>                               '   +
				'		<td>'+goods[j].goodsName+'</td>                 '   +
				'		<td>'+goods[j].goodsCode+'</td>              '   +
				'		<td>'+goods[j].goodsUnit+'</td>                    '   +
				'		<td>'+goods[j].sellNumber+'</td>                   '   +
				'		<td colspan="2">'+goods[j].goodsPrice+'</td>      '   +
				'	</tr>';
				}
			$("#d").append($('<!--startprint--><table align="center" id ="tab">                '   +
			'	<tr><th colspan="6">永顺衡器</th></tr>'+
			'	<tr>                               '   +
			'		<th>销售单号</th>              '   +
			'		<th>销售时间</th>              '   +
			'		<th>客户姓名</th>              '   +
			'		<th>客户电话</th>              '   +
			'		<th>卖家电话</th>              '   +
			'		<th>联系人</th>                '   +
			'	</tr>                              '   +
			'	<tr>                               '   +
			'		<td>'+res[i].id+'</td>                   '   +
			'		<td>'+time+'</td>            '   +
			'		<td>'+res[i].sellBy+'</td>                '   +
			'		<td>'+res[i].phone+'</td>             '   +
			'		<td>13983481511</td>            '   +
			'		<td>蒋立友</td>                '   +
			'	</tr>                              '   +
			'	<tr>                               '   +
			'		<th>货物名称</th>              '   +
			'		<th>货物编号</th>              '   +
			'		<th>单位</th>                  '   +
			'		<th>销售数量</th>              '   +
			'		<th colspan="2">销售价格（元）</th>'+
			'	</tr>                              '   +
			str+
			'	<tr>                               '   +
			'		<td colspan="4">总价（元）</td>'   +
			'		<td colspan="2">'+res[i].sellPrice+'</td>    '   +
			'	</tr>                              '   +
			'</table>       <!--endprint-->                       '));
		}
	}
   	$("button").click(function(){
   		bdhtml=window.document.body.innerHTML;
        sprnstr="<!--startprint-->"; //开始打印标识字符串有17个字符
        eprnstr="<!--endprint-->"; //结束打印标识字符串
        prnhtml=bdhtml.substr(bdhtml.indexOf(sprnstr)+17); //从开始打印标识之后的内容
        prnhtml=prnhtml.substring(0,prnhtml.indexOf(eprnstr)); //截取开始标识和结束标识之间的内容
        window.document.body.innerHTML=prnhtml; //把需要打印的指定内容赋给body.innerHTML
        window.print(); //调用浏览器的打印功能打印指定区域
        window.document.body.innerHTML=bdhtml; // 最后还原页面
   	});
</script>
</body>
</html>